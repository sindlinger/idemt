INSTRUCOES DE EXECUCAO (OBRIGATORIAS):
- Execute tudo ate concluir, sem pausar para "proximos passos".
- Nao escreva plano nem pergunte para continuar.
- Se faltar info, use defaults razoaveis e declare no final.
- Pare apenas se houver risco real de acao destrutiva nao solicitada.
- Teste sempre: rode build/teste/smoke real, corrija erros e repita ate passar.
- Consulte o servico e mantenha ele executando: verifique ping via cmdmt, tente iniciar o servico se necessario e confirme resposta.

# AGENTS.md â€” Codex Instructions (cmdmt / add-rm / expert / tester)

## Papel
Voce e o Codex CLI agent no repositorio atual. Sua missao e profissionalizar o CLI `cmdmt` para que o usuario possa rodar comandos simples e deterministicos, com defaults claros e sem heuristica.

## Objetivo principal
Deixar defaults obrigatorios prontos para o usuario. Ele so digita TF e nome do indicador/expert. Alem disso, fazer o tester do expert funcionar.

## Tarefas obrigatorias
1) Defaults deterministas (sem heuristica)
- Fonte de verdade explicita: config, env vars ou perfil MT definido.
- Ordem de resolucao (deterministica):
  1. Argumentos explicitos no CLI
  2. Variaveis de ambiente (ex: `CMDMT_SYMBOL`, `CMDMT_PROFILE`, `CMDMT_MT5_PATH`)
  3. Config file do `cmdmt` (ex: `~/.cmdmt/config.json`)
  4. Perfil MT definido pelo usuario (id/pasta), nunca por heuristica
- Se algum default obrigatorio estiver ausente, erro claro + instrucao de como configurar.

2) UX minima para indicador e expert (defaults)
- Comando curto para indicador: `add -i <TF> <NOME> [sub=N] [k=v ...]`
- Remover aliases de `indicator/indicador` e `expert attach/detach`.
- Novo comando para expert no grafico: `expert run <TF> <NOME> [k=v ...]`
- Novo comando para tester do expert: `expert test <TF> <NOME> [k=v ...]`
- Todos sem SYMBOL; SYMBOL/PROFILE devem vir dos defaults acima.

3) Tester do expert (Strategy Tester)
- Implementar o fluxo completo no CLI e no service, se necessario.
- Disparar Strategy Tester com EA e parametros informados (sem heuristica).
- Permitir escolher onde executar:
  - MT atual (com DLL/automacao e Strategy Tester)
  - MT especial (instancia dedicada ja prevista no codigo)
- Criar flag clara (ex: `--runner=active|special`) com fallback explicito.
- Se o MT especial falhar (download/instalacao), corrigir e registrar log claro.

4) Execucao em qualquer diretorio (WSL ou Windows)
- Garantir que `cmdmt` funcione de qualquer lugar.
- Disponibilizar wrappers/shims:
  - WSL: symlink em `/usr/local/bin` ou similar.
- Nada deve depender do cwd.

5) OneShot (experts e execucao)
- Procurar no repo por `OneShot` e integrar fluxo de:
  - adicionar expert desconhecido
  - rodar aplicador
  - rodar expert em test
- Reusar comandos existentes da biblioteca, sem duplicar logica.

## Requisitos de qualidade
- CLI profissional com QCLI:
  - help/usage completos
  - mensagens de erro uteis
  - exit codes corretos
  - JSON output opcional (`--json`)
- Zero heuristica implicita; tudo deve ser configuravel e transparente.
- Testes basicos de parsing e defaults (se ja existir infra de testes).

## Validacao obrigatoria
- Sempre executar build/testes (ou smoke tests) e repetir ate passar.
- Verificar servico (socket) com `cmdmt ping` e registrar se respondeu.
- Se o servico nao responder, iniciar o bootstrap/servico indicado no repo e repetir a verificacao.

## Criterios de aceite
- `add -i M5 ZigZag` funciona com defaults explicitos.
- `expert run M5 MyEA` anexa e roda o EA no grafico.
- `expert test M5 MyEA` inicia o Strategy Tester e gera log/resultado.
- `cmdmt ping` responde.

## Estilo de entrega
- Codigo limpo, pequenas mudancas incrementais.
- Nao remover logica existente sem autorizacao.
- Atualizar docs do CLI.
